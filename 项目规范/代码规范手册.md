# 一、命名

## 变量命名

命名时以字母 a 到 Z 或 a 到 Z 或下划线开头，后面跟着零或更多的字母、下划线和数字(0 到 9)。Go 不允许在命名时中使用@、$和%等标点符号。

- 当命名（包括常量、变量、类型、函数名、结构字段等等）以一个大写字母开头，那么使用这种形式的标识符的对象就**可以被外部包的代码所使用**。例如：`Group1`。
- 命名如果以小写字母开头，则对包外是不可见的，但是他们在**整个包的内部是可见并且可用的**。例如：`group1`。

- 变量名称一般遵循驼峰法，首字母根据访问控制原则大写或者小写，但遇到特有名词时，需要遵循以下规则： 
  - 如果变量为私有，且特有名词为首个单词，则使用小写，如：`apiClient`。
  - 其它情况都应当使用该名词原有的写法，如：`APIClient`、`repoID`、`UserID`。
  - 错误示例：`UrlArray`，应该写成`urlArray` 或者`URLArray`。
- 若变量类型为`bool`类型，则名称应以`Has`，`Is`，`Can`或`Allow`开头。例如：`canManage`。

## 包命名

保持package的名字和目录保持一致，尽量采取有意义的包名，简短，有意义，尽量和标准库不要冲突。包名应该为**小写**单词，不要使用下划线或者混合大小写。例如：`main`。

## 文件命名

尽量采取有意义的文件名，简短，有意义，应该为**小写**单词，使用**下划线**分隔各个单词。例如：`my_test.go`。

## 结构体命名

- 采用**驼峰命名法**，首字母根据访问控制大写或者小写。
- struct 申明和初始化格式采用多行，例如：

```go
// 多行申明
type User struct{
    Username  string
    Email     string
}

// 多行初始化
u := User{
    Username: "astaxie",
    Email:    "astaxie@gmail.com",
}
```

## 常量命名

常量均需使用全部大写字母组成，并使用下划线分词。例如：`const APP_VERSION = "1.0"`。

# 二、注释

## 包注释

每个包都应该有一个包注释，一个位于`package`子句之前的块注释或行注释。包如果有多个 Go 文件，只需要出现在一个 Go 文件中（一般是和包同名的文件）即可。 包注释应该包含下面基本信息(请严格按照这个顺序，简介，创建人，创建时间）：

- 包的基本简介（包名，简介）
- 创建者，格式： 创建人： rtx 名
- 创建时间，格式：创建时间： yyyy-MM-dd

例如 util 包的注释：

```go
// util 包， 该包包含了项目共用的一些常量，封装了项目中一些共用函数。
// 创建人： test
// 创建时间： 2019-04-19
```

## 结构（接口）注释

每个自定义的结构体或者接口都应该有注释说明，该注释对结构进行简要介绍，放在结构体定义的前一行，格式为： 结构体名， 结构体说明。同时结构体内的每个成员变量都要有说明，该说明放在成员变量的后面（注意对齐），例如：

```go
// User ， 用户对象，定义了用户的基础信息
type User struct{
    Username  string // 用户名
    Email     string // 邮箱
}
```

## 函数（方法）注释

每个函数，或者方法（结构体或者接口下的函数称为方法）都应该有注释说明，函数的注释应该包括三个方面（严格按照此顺序撰写）：

- 简要说明，格式说明：以函数名开头，“，”分隔说明部分
- 参数列表：每行一个参数，参数名开头，“，”分隔说明部分
- 返回值： 每行一个返回值

例如：

```go
// NewtAttrModel ， 属性数据层操作类的工厂方法
// 参数：
//      ctx ： 上下文信息
// 返回值：
//      属性操作类指针
func NewAttrModel(ctx *common.Context) *AttrModel {
}
```

## 代码逻辑注释

对于一些关键位置的代码逻辑，或者局部较为复杂的逻辑，需要有相应的逻辑说明，方便其他开发者阅读该段代码。

## 注释风格

统一使用中文注释，对于中英文字符之间使用空格分隔， 中文和英文之间要使用空格分隔（英文和中文标点不使用空格分隔），例如：`// 从 Redis 中批量读取属性，对于没有读取到的 id，记录到一个数组里面，准备从 DB 中读取`。

# 代码风格

## 缩进和折行

- 缩进直接使用 gofmt 工具格式化即可（gofmt 是使用 tab 缩进的）。
- 折行方面，一行最长不超过80个字符，超过的请使用换行展示，尽量保持格式优雅。

## 语句结尾

结尾不使用分号结尾。严禁将多个语句写到同一行（`for` 等除外）。

## 括号和空格

括号和空格方面，也可以直接使用 gofmt 工具格式化（Go 会强制左大括号不换行，换行会报语法错误），所有的运算符和操作数之间要留空格。

## import 规范

import在多行的情况下，goimports会自动帮你格式化，但是我们这里还是规范一下import的一些规范，如果你在一个文件里面引入了一个package，还是建议采用如下格式：

```go
import (
    "fmt"
)
```

如果你的包引入了三种类型的包，标准库包，程序内部包，第三方包，建议采用如下方式进行组织你的包：

```go
import (
    "strings"
    "encoding/json"
    
    "myproject/models"
    "myproject/controller"
    "myproject/utils"
    
    "github.com/astaxie/beego"
    "github.com/go-sql-driver/mysql"
)   
```

有顺序的引入包，不同的类型采用空格分离，第一种实标准库，第二是项目包，第三是第三方包。在项目中不要使用相对路径引入包。

## 错误处理

- 错误处理的原则就是不能丢弃任何有返回err的调用，不要使用 _ 丢弃，必须全部处理。接收到错误，要么返回err，或者使用log记录下来
- 尽早return：一旦有错误发生，马上返回
- 尽量不要使用panic，除非你知道你在做什么
- 错误描述如果是英文必须为小写，不需要标点结尾
- 采用独立的错误流进行处理

例如：

```go
// 错误写法
if err != nil {
    // error handling
} else {
    // normal code
}

// 正确写法
if err != nil {
    // error handling
    return // or continue, etc.
}
// normal code
```

## 测试

单元测试文件名命名规范为`example_test.go`测试用例的函数名称必须以`Test`开头，例如：`TestExample`每个重要的函数都要首先编写测试用例，测试用例和正规代码一起提交方便进行回归测试。